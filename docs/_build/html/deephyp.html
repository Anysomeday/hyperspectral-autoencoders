

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>deephyp package &mdash; deephyp 0.1.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> deephyp
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/citing.html">How to cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/examples.html">Code Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/related_pubs.html">Related Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">deephyp</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>deephyp package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/deephyp.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="deephyp-package">
<h1>deephyp package<a class="headerlink" href="#deephyp-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-deephyp.autoencoder">
<span id="deephyp-autoencoder-module"></span><h2>deephyp.autoencoder module<a class="headerlink" href="#module-deephyp.autoencoder" title="Permalink to this headline">¶</a></h2>
<p>Description: high-level deep learning classes for building, training and using unsupervised autoencoders. Uses
functions from the low-level network_ops module.</p>
<ul class="simple">
<li>File name: autoencoder.py</li>
<li>Author: Lloyd Windrim</li>
<li>Date created: June 2019</li>
<li>Python package: deephyp</li>
</ul>
<dl class="class">
<dt id="deephyp.autoencoder.cnn_1D_network">
<em class="property">class </em><code class="descclassname">deephyp.autoencoder.</code><code class="descname">cnn_1D_network</code><span class="sig-paren">(</span><em>configFile=None, inputSize=None, zDim=5, encoderNumFilters=[10, 10, 10], encoderFilterSize=[20, 10, 10], activationFunc='sigmoid', tiedWeights=None, weightInitOpt='truncated_normal', weightStd=0.1, skipConnect=False, padding='VALID', encoderStride=[1, 1, 1], activationFuncFinal='linear'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#cnn_1D_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for setting up a 1-D convolutional autoencoder network. Builds a network with an encoder containing          convolutional layers followed by a single fully-connected layer to map from the final convolutional layer in         the encoder to the latent layer. The decoder contains a single fully-connected layer and then several         deconvolutional layers which reconstruct the spectra in the output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>configFile</strong> (<em>str</em>) – Optional way of setting up the network. All other inputs can be ignored (will be overwritten).                         Pass the address of the .json config file.</li>
<li><strong>inputSize</strong> (<em>int</em>) – Number of dimensions of input data (i.e. number of spectral bands). Value must be input if not                         using a config file.</li>
<li><strong>zDim</strong> (<em>int</em>) – Dimensionality of latent vector.</li>
<li><strong>encoderNumFilters</strong> (<em>int list</em>) – Number of filters at each layer of the encoder. List length is number of                         convolutional encoder layers. Note that there is a single mlp layer after the last                         convolutional layer.</li>
<li><strong>encoderFilterSize</strong> (<em>int list</em>) – Size of filter at each layer of the encoder. List length is number of encoder layers.</li>
<li><strong>activationFunc</strong> (<em>str</em>) – Activation function for all layers except the last one. Current options: [‘sigmoid’,                         ‘relu’, ‘linear’].</li>
<li><strong>tiedWeights</strong> (<em>binary list</em><em> or </em><em>None</em>) – Specifies whether or not to tie weights at each layer:
- 1: tied weights of specific encoder layer to corresponding decoder weights
- 0: do not tie weights of specific layer
- None: sets all layers to 0</li>
<li><strong>weightInitOpt</strong> (<em>string</em>) – Method of weight initialisation. Current options: [‘gaussian’, ‘truncated_normal’,                     ‘xavier’, ‘xavier_improved’].</li>
<li><strong>weightStd</strong> (<em>float</em>) – Used by ‘gaussian’ and ‘truncated_normal’ weight initialisation methods.</li>
<li><strong>skipConnect</strong> (<em>boolean</em>) – Whether to use skip connections throughout the network.</li>
<li><strong>padding</strong> (<em>str</em>) – Type of padding used. Current options: [‘VALID’, ‘SAME’].</li>
<li><strong>encoderStride</strong> (<em>int list</em>) – Stride at each convolutional encoder layer.</li>
<li><strong>activationFuncFinal</strong> (<em>str</em>) – Activation function for final layer. Current options: [‘sigmoid’, ‘relu’, ‘linear’].</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.inputSize">
<code class="descname">inputSize</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.inputSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of dimensions of input data (i.e. number of spectral bands).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.activationFunc">
<code class="descname">activationFunc</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.activationFunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Activation function for all layers except the last one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.tiedWeights">
<code class="descname">tiedWeights</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.tiedWeights" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether (1) or not (0) the weights of an encoder layer are tied to a decoder layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">binary list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.skipConnect">
<code class="descname">skipConnect</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.skipConnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the network uses skip connections between corresponding encoder and decoder layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">boolean</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.weightInitOpt">
<code class="descname">weightInitOpt</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.weightInitOpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Method of weight initialisation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.weightStd">
<code class="descname">weightStd</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.weightStd" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter for ‘gaussian’ and ‘truncated_normal’ weight initialisation methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.activationFuncFinal">
<code class="descname">activationFuncFinal</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.activationFuncFinal" title="Permalink to this definition">¶</a></dt>
<dd><p>Activation function for final layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.encoderNumFilters">
<code class="descname">encoderNumFilters</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.encoderNumFilters" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of filters at each layer of the encoder. List length is number of                         convolutional encoder layers. Note that there is a single mlp layer after the last                         convolutional layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.encoderFilterSize">
<code class="descname">encoderFilterSize</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.encoderFilterSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of filter at each layer of the encoder. List length is number of encoder layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.encoderStride">
<code class="descname">encoderStride</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.encoderStride" title="Permalink to this definition">¶</a></dt>
<dd><p>Stride at each convolutional encoder layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.decoderNumFilters">
<code class="descname">decoderNumFilters</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.decoderNumFilters" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.decoderFilterSize">
<code class="descname">decoderFilterSize</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.decoderFilterSize" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.decoderStride">
<code class="descname">decoderStride</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.decoderStride" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.zDim">
<code class="descname">zDim</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.zDim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensionality of latent vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.padding">
<code class="descname">padding</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of padding used. Current options: [‘VALID’, ‘SAME’].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.z">
<code class="descname">z</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.z" title="Permalink to this definition">¶</a></dt>
<dd><p>Latent representation of data. Accessible through the <em>encoder</em> class function, requiring a trained             model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">tensor</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.y_recon">
<code class="descname">y_recon</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.y_recon" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstructed output of network. Accessible through the <em>decoder</em> and <em>encoder_decoder</em> class             functions, requiring a trained model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">tensor</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.train_ops">
<code class="descname">train_ops</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.train_ops" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of names of train and loss ops (suffixed with _train and _loss) added to the             network using the <em>add_train_op</em> class function. The name (without suffix) is passed to the <em>train</em> class             function to train the network with the referenced train and loss op.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.cnn_1D_network.modelsAddrs">
<code class="descname">modelsAddrs</code><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.modelsAddrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of model names added to the network using the <em>add_model</em> class function. The             names reference models which can be used by the <em>encoder</em>, <em>decoder</em> and <em>encoder_decoder</em> class functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.autoencoder.cnn_1D_network.add_model">
<code class="descname">add_model</code><span class="sig-paren">(</span><em>addr</em>, <em>modelName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#cnn_1D_network.add_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.add_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a saved set of model parameters for the network.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>addr</strong> (<em>str</em>) – Address of the directory containing the checkpoint files.</li>
<li><strong>modelName</strong> (<em>str</em>) – Name of the model (to refer to it later in-case of multiple models for a given network).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.autoencoder.cnn_1D_network.add_train_op">
<code class="descname">add_train_op</code><span class="sig-paren">(</span><em>name</em>, <em>lossFunc='SSE'</em>, <em>learning_rate=0.001</em>, <em>decay_steps=None</em>, <em>decay_rate=None</em>, <em>piecewise_bounds=None</em>, <em>piecewise_values=None</em>, <em>method='Adam'</em>, <em>wd_lambda=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#cnn_1D_network.add_train_op"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.add_train_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a loss op and training op from a specific loss function and optimiser. User gives the ops a name,             and the train op and loss opp are stored in a dictionary (train_ops) under that name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>str</em>) – Name of the training op (to refer to it later in-case of multiple training ops).</li>
<li><strong>lossFunc</strong> (<em>str</em>) – Reconstruction loss function.</li>
<li><strong>learning_rate</strong> (<em>float</em>) – Controls the degree to which the weights are updated during training.</li>
<li><strong>decay_steps</strong> (<em>int</em>) – Epoch frequency at which to decay the learning rate.</li>
<li><strong>decay_rate</strong> (<em>float</em>) – Fraction at which to decay the learning rate.</li>
<li><strong>piecewise_bounds</strong> (<em>int list</em>) – Epoch step intervals for decaying the learning rate. Alternative to decay steps.</li>
<li><strong>piecewise_values</strong> (<em>float list</em>) – Rate at which to decay the learning rate at the piecewise_bounds.</li>
<li><strong>method</strong> (<em>str</em>) – Optimisation method.</li>
<li><strong>wd_lambda</strong> (<em>float</em>) – Scalar to control weighting of weight decay in loss.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.autoencoder.cnn_1D_network.decoder">
<code class="descname">decoder</code><span class="sig-paren">(</span><em>modelName</em>, <em>dataZ</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#cnn_1D_network.decoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.decoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the reconstruction of some dataSamples from their latent representation encoding  using a trained             model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>modelName</strong> (<em>str</em>) – Name of the model to use (previously added with add_model() ).</li>
<li><strong>dataZ</strong> (<em>np.array</em>) – Latent representation of data samples to reconstruct using the network. Shape                     [numSamples x arbitrary].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Reconstructed data (y_recon attribute). Shape [numSamples x arbitrary].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.autoencoder.cnn_1D_network.encoder">
<code class="descname">encoder</code><span class="sig-paren">(</span><em>modelName</em>, <em>dataSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#cnn_1D_network.encoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.encoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the latent variable of some dataSamples using a trained model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>modelName</strong> (<em>str</em>) – Name of the model to use (previously added with add_model() ).</li>
<li><strong>dataSample</strong> (<em>np.array</em>) – Shape [numSamples x inputSize].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Latent representation z of dataSamples. Shape [numSamples x arbitrary].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.autoencoder.cnn_1D_network.encoder_decoder">
<code class="descname">encoder_decoder</code><span class="sig-paren">(</span><em>modelName</em>, <em>dataSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#cnn_1D_network.encoder_decoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.encoder_decoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the reconstruction of some dataSamples using a trained model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>modelName</strong> (<em>str</em>) – Name of the model to use (previously added with add_model() ).</li>
<li><strong>dataSample</strong> (<em>np.array</em>) – Data samples to reconstruct using the network. Shape [numSamples x inputSize].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Reconstructed data (y_recon attribute). Shape [numSamples x arbitrary].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.autoencoder.cnn_1D_network.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>dataTrain, dataVal, train_op_name, n_epochs, save_addr, visualiseRateTrain=0, visualiseRateVal=0, save_epochs=[1000]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#cnn_1D_network.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.cnn_1D_network.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls network_ops function to train a network.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataTrain</strong> (<em>obj</em>) – Iterator object for training data.</li>
<li><strong>dataVal</strong> (<em>obj</em>) – Iterator object for validation data.</li>
<li><strong>train_op_name</strong> (<em>str</em>) – Name of training op created.</li>
<li><strong>n_epochs</strong> (<em>int</em>) – Number of loops through dataset to train for.</li>
<li><strong>save_addr</strong> (<em>str</em>) – Address of a directory to save checkpoints for desired epochs, or address of saved                         checkpoint. If address is for an epoch and contains a previously saved checkpoint, then the                         network will start training from there. Otherwise it will be trained from scratch.</li>
<li><strong>visualiseRateTrain</strong> (<em>int</em>) – Epoch rate at which to print training loss in console.</li>
<li><strong>visualiseRateVal</strong> (<em>int</em>) – Epoch rate at which to print validation loss in console.</li>
<li><strong>save_epochs</strong> (<em>int list</em>) – Epochs to save checkpoints at.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="deephyp.autoencoder.mlp_1D_network">
<em class="property">class </em><code class="descclassname">deephyp.autoencoder.</code><code class="descname">mlp_1D_network</code><span class="sig-paren">(</span><em>configFile=None, inputSize=None, encoderSize=[50, 30, 10], activationFunc='sigmoid', tiedWeights=None, weightInitOpt='truncated_normal', weightStd=0.1, skipConnect=False, activationFuncFinal='linear'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#mlp_1D_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for setting up a 1-D multi-layer perceptron (mlp) autoencoder network. Layers are all fully-connected         (i.e. dense).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>configFile</strong> (<em>str</em>) – Optional way of setting up the network. All other inputs can be ignored (will be overwritten).                         Pass the address of the .json config file.</li>
<li><strong>inputSize</strong> (<em>int</em>) – Number of dimensions of input data (i.e. number of spectral bands). Value must be input if                         not using a config file.</li>
<li><strong>encoderSize</strong> (<em>int list</em>) – Number of nodes at each layer of the encoder. List length is number of encoder layers.</li>
<li><strong>activationFunc</strong> (<em>str</em>) – Activation function for all layers except the last one. Current options: [‘sigmoid’,                         ‘relu’, ‘linear’].</li>
<li><strong>tiedWeights</strong> (<em>binary list</em><em> or </em><em>None</em>) – Specifies whether or not to tie weights at each layer:
- 1: tied weights of specific encoder layer to corresponding decoder weights
- 0: do not tie weights of specific layer
- None: sets all layers to 0</li>
<li><strong>weightInitOpt</strong> (<em>string</em>) – Method of weight initialisation. Current options: [‘gaussian’, ‘truncated_normal’,                         ‘xavier’, ‘xavier_improved’].</li>
<li><strong>weightStd</strong> (<em>float</em>) – Used by ‘gaussian’ and ‘truncated_normal’ weight initialisation methods.</li>
<li><strong>skipConnect</strong> (<em>boolean</em>) – Whether to use skip connections throughout the network.</li>
<li><strong>activationFuncFinal</strong> (<em>str</em>) – Activation function for final layer. Current options: [‘sigmoid’, ‘relu’, ‘linear’].</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="deephyp.autoencoder.mlp_1D_network.inputSize">
<code class="descname">inputSize</code><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.inputSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of dimensions of input data (i.e. number of spectral bands).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.mlp_1D_network.activationFunc">
<code class="descname">activationFunc</code><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.activationFunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Activation function for all layers except the last one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.mlp_1D_network.tiedWeights">
<code class="descname">tiedWeights</code><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.tiedWeights" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether (1) or not (0) the weights of an encoder layer are tied to a decoder layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">binary list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.mlp_1D_network.skipConnect">
<code class="descname">skipConnect</code><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.skipConnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the network uses skip connections between corresponding encoder and decoder layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">boolean</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.mlp_1D_network.weightInitOpt">
<code class="descname">weightInitOpt</code><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.weightInitOpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Method of weight initialisation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.mlp_1D_network.weightStd">
<code class="descname">weightStd</code><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.weightStd" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter for ‘gaussian’ and ‘truncated_normal’ weight initialisation methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.mlp_1D_network.activationFuncFinal">
<code class="descname">activationFuncFinal</code><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.activationFuncFinal" title="Permalink to this definition">¶</a></dt>
<dd><p>Activation function for final layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.mlp_1D_network.encoderSize">
<code class="descname">encoderSize</code><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.encoderSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of inputs and number of nodes at each layer of the encoder.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.mlp_1D_network.decoderSize">
<code class="descname">decoderSize</code><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.decoderSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of nodes at each layer of the decoder and number of outputs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.mlp_1D_network.z">
<code class="descname">z</code><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.z" title="Permalink to this definition">¶</a></dt>
<dd><p>Latent representation of data. Accessible through the <em>encoder</em> class function, requiring a trained             model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">tensor</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.mlp_1D_network.y_recon">
<code class="descname">y_recon</code><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.y_recon" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstructed output of network. Accessible through the <em>decoder</em> and <em>encoder_decoder</em> class             functions, requiring a trained model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">tensor</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.mlp_1D_network.train_ops">
<code class="descname">train_ops</code><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.train_ops" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of names of train and loss ops (suffixed with _train and _loss) added to the             network using the <em>add_train_op</em> class function. The name (without suffix) is passed to the <em>train</em> class             function to train the network with the referenced train and loss op.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.autoencoder.mlp_1D_network.modelsAddrs">
<code class="descname">modelsAddrs</code><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.modelsAddrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of model names added to the network using the <em>add_model</em> class function. The             names reference models which can be used by the <em>encoder</em>, <em>decoder</em> and <em>encoder_decoder</em> class functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.autoencoder.mlp_1D_network.add_model">
<code class="descname">add_model</code><span class="sig-paren">(</span><em>addr</em>, <em>modelName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#mlp_1D_network.add_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.add_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a saved set of model parameters for the network.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>addr</strong> (<em>str</em>) – Address of the directory containing the checkpoint files.</li>
<li><strong>modelName</strong> (<em>str</em>) – Name of the model (to refer to it later in-case of multiple models for a given network).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.autoencoder.mlp_1D_network.add_train_op">
<code class="descname">add_train_op</code><span class="sig-paren">(</span><em>name</em>, <em>lossFunc='CSA'</em>, <em>learning_rate=0.001</em>, <em>decay_steps=None</em>, <em>decay_rate=None</em>, <em>piecewise_bounds=None</em>, <em>piecewise_values=None</em>, <em>method='Adam'</em>, <em>wd_lambda=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#mlp_1D_network.add_train_op"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.add_train_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a loss op and training op from a specific loss function and optimiser. User gives the ops a             name, and the train op and loss opp are stored in a dictionary (train_ops) under that name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>str</em>) – Name of the training op (to refer to it later in-case of multiple training ops).</li>
<li><strong>lossFunc</strong> (<em>str</em>) – Reconstruction loss function.</li>
<li><strong>learning_rate</strong> (<em>float</em>) – Controls the degree to which the weights are updated during training.</li>
<li><strong>decay_steps</strong> (<em>int</em>) – Epoch frequency at which to decay the learning rate.</li>
<li><strong>decay_rate</strong> (<em>float</em>) – Fraction at which to decay the learning rate.</li>
<li><strong>piecewise_bounds</strong> (<em>int list</em>) – Epoch step intervals for decaying the learning rate. Alternative to decay steps.</li>
<li><strong>piecewise_values</strong> (<em>float list</em>) – Rate at which to decay the learning rate at the piecewise_bounds.</li>
<li><strong>method</strong> (<em>str</em>) – Optimisation method.</li>
<li><strong>wd_lambda</strong> (<em>float</em>) – Scalar to control weighting of weight decay in loss.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.autoencoder.mlp_1D_network.decoder">
<code class="descname">decoder</code><span class="sig-paren">(</span><em>modelName</em>, <em>dataZ</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#mlp_1D_network.decoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.decoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the reconstruction of some dataSamples from their latent representation encoding  using a trained             model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>modelName</strong> (<em>str</em>) – Name of the model to use (previously added with add_model() ).</li>
<li><strong>dataZ</strong> (<em>np.array</em>) – Latent representation of data samples to reconstruct using the network. Shape                     [numSamples x arbitrary].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Reconstructed data (y_recon attribute). Shape [numSamples x arbitrary].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.autoencoder.mlp_1D_network.encoder">
<code class="descname">encoder</code><span class="sig-paren">(</span><em>modelName</em>, <em>dataSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#mlp_1D_network.encoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.encoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the latent variable of some dataSamples using a trained model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>modelName</strong> (<em>str</em>) – Name of the model to use (previously added with add_model() ).</li>
<li><strong>dataSample</strong> (<em>np.array</em>) – Shape [numSamples x inputSize].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Latent representation z of dataSamples. Shape [numSamples x arbitrary].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.autoencoder.mlp_1D_network.encoder_decoder">
<code class="descname">encoder_decoder</code><span class="sig-paren">(</span><em>modelName</em>, <em>dataSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#mlp_1D_network.encoder_decoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.encoder_decoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the reconstruction of some dataSamples using a trained model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>modelName</strong> (<em>str</em>) – Name of the model to use (previously added with add_model() ).</li>
<li><strong>dataSample</strong> (<em>np.array</em>) – Data samples to reconstruct using the network. Shape [numSamples x inputSize].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Reconstructed data (y_recon attribute). Shape [numSamples x arbitrary].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.autoencoder.mlp_1D_network.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>dataTrain, dataVal, train_op_name, n_epochs, save_addr, visualiseRateTrain=0, visualiseRateVal=0, save_epochs=[1000]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/autoencoder.html#mlp_1D_network.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.autoencoder.mlp_1D_network.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls network_ops function to train a network.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataTrain</strong> (<em>obj</em>) – Iterator object for training data.</li>
<li><strong>dataVal</strong> (<em>obj</em>) – Iterator object for validation data.</li>
<li><strong>train_op_name</strong> (<em>str</em>) – Name of training op created.</li>
<li><strong>n_epochs</strong> (<em>int</em>) – Number of loops through dataset to train for.</li>
<li><strong>save_addr</strong> (<em>str</em>) – Address of a directory to save checkpoints for desired epochs, or address of saved                         checkpoint. If address is for an epoch and contains a previously saved checkpoint, then the                         network will start training from there. Otherwise it will be trained from scratch.</li>
<li><strong>visualiseRateTrain</strong> (<em>int</em>) – Epoch rate at which to print training loss in console.</li>
<li><strong>visualiseRateVal</strong> (<em>int</em>) – Epoch rate at which to print validation loss in console.</li>
<li><strong>save_epochs</strong> (<em>int list</em>) – Epochs to save checkpoints at.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-deephyp.classifier">
<span id="deephyp-classifier-module"></span><h2>deephyp.classifier module<a class="headerlink" href="#module-deephyp.classifier" title="Permalink to this headline">¶</a></h2>
<p>Description: high-level deep learning classes for building, training and using supervised neural network     classifiers. Uses functions from the low-level network_ops module.</p>
<ul class="simple">
<li>File name: classifier.py</li>
<li>Author: Lloyd Windrim</li>
<li>Date created: August 2019</li>
<li>Python package: deephyp</li>
</ul>
<dl class="class">
<dt id="deephyp.classifier.cnn_1D_network">
<em class="property">class </em><code class="descclassname">deephyp.classifier.</code><code class="descname">cnn_1D_network</code><span class="sig-paren">(</span><em>configFile=None, inputSize=None, numClasses=None, convFilterSize=[20, 10, 10], convNumFilters=[10, 10, 10], convStride=[1, 1, 1], fcSize=[20, 20], activationFunc='relu', weightInitOpt='truncated_normal', weightStd=0.1, padding='VALID'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/classifier.html#cnn_1D_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.classifier.cnn_1D_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for setting up a 1-D convolutional neural network (cnn) for classification. Contains several convolutional         layers followed by several fully-connected layers. The network outputs scores for each class, for a given set         of input data samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>configFile</strong> (<em>str</em>) – Optional way of setting up the network. All other inputs can be ignored (will be overwritten).                         Pass the address of the .json config file.</li>
<li><strong>inputSize</strong> (<em>int</em>) – Number of dimensions of input data (i.e. number of spectral bands). Value must be input if not                         using a config file.</li>
<li><strong>numClasses</strong> (<em>int</em>) – Number of labelled classes in the dataset (not including the zero class).</li>
<li><strong>convFilterSize</strong> (<em>int list</em>) – Size of filter at each convolutional layer. List length is number of                         convolutional layers.</li>
<li><strong>convNumFilters</strong> (<em>int list</em>) – Number of filters at each convolutional layer of the network. List length is                         number of convolutional layers.</li>
<li><strong>convStride</strong> (<em>int list</em>) – Stride at each convolutional layer. List length is number of convolutional layers.         fcSize (int list): Number of nodes at each fully-connected (i.e. dense) layer of the encoder. List length                         is number of fully-connected layers.</li>
<li><strong>activationFunc</strong> (<em>str</em>) – Activation function for all layers except the last one. Current options: [‘sigmoid’,                         ‘relu’, ‘linear’].</li>
<li><strong>weightInitOpt</strong> (<em>string</em>) – Method of weight initialisation. Current options: [‘gaussian’, ‘truncated_normal’,                     ‘xavier’, ‘xavier_improved’].</li>
<li><strong>weightStd</strong> (<em>float</em>) – Used by ‘gaussian’ and ‘truncated_normal’ weight initialisation methods.</li>
<li><strong>padding</strong> (<em>str</em>) – Type of padding used. Current options: [‘VALID’, ‘SAME’].</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="deephyp.classifier.cnn_1D_network.inputSize">
<code class="descname">inputSize</code><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.inputSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of dimensions of input data (i.e. number of spectral bands).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.classifier.cnn_1D_network.activationFunc">
<code class="descname">activationFunc</code><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.activationFunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Activation function for all layers except the last one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.classifier.cnn_1D_network.weightInitOpt">
<code class="descname">weightInitOpt</code><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.weightInitOpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Method of weight initialisation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.classifier.cnn_1D_network.weightStd">
<code class="descname">weightStd</code><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.weightStd" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter for ‘gaussian’ and ‘truncated_normal’ weight initialisation methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.classifier.cnn_1D_network.convFilterSize">
<code class="descname">convFilterSize</code><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.convFilterSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of filter at each convolutional layer. List length is number of                         convolutional layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.classifier.cnn_1D_network.convNumFilters">
<code class="descname">convNumFilters</code><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.convNumFilters" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of filters at each convolutional layer of the network. List length is                         number of convolutional layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.classifier.cnn_1D_network.convStride">
<code class="descname">convStride</code><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.convStride" title="Permalink to this definition">¶</a></dt>
<dd><p>Stride at each convolutional layer. List length is number of convolutional layers.         padding (str): Type of padding used. Current options: [‘VALID’, ‘SAME’].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.classifier.cnn_1D_network.fcSize">
<code class="descname">fcSize</code><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.fcSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of nodes at each fully-connected (i.e. dense) layer of the encoder. List length                         is number of fully-connected layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.classifier.cnn_1D_network.numLayers">
<code class="descname">numLayers</code><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.numLayers" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of layers (convolutional and fully-connected).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.classifier.cnn_1D_network.y_pred">
<code class="descname">y_pred</code><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.y_pred" title="Permalink to this definition">¶</a></dt>
<dd><p>Output of network - class scores with shape [numSamples x numClasses]. Accessible through the             <em>predict_scores</em> class functions, requiring a trained model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">tensor</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.classifier.cnn_1D_network.train_ops">
<code class="descname">train_ops</code><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.train_ops" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of names of train and loss ops (suffixed with _train and _loss) added to the             network using the <em>add_train_op</em> class function. The name (without suffix) is passed to the <em>train</em> class             function to train the network with the referenced train and loss op.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.classifier.cnn_1D_network.modelsAddrs">
<code class="descname">modelsAddrs</code><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.modelsAddrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of model names added to the network using the <em>add_model</em> class function. The             names reference models which can be used by the <em>predict_scores</em>, <em>predict_labels</em> and <em>predict_features</em>             class functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.classifier.cnn_1D_network.add_model">
<code class="descname">add_model</code><span class="sig-paren">(</span><em>addr</em>, <em>modelName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/classifier.html#cnn_1D_network.add_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.add_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a saved set of model parameters for the network.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>addr</strong> (<em>str</em>) – Address of the directory containing the checkpoint files.</li>
<li><strong>modelName</strong> (<em>str</em>) – Name of the model (to refer to it later in-case of multiple models for a given network).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.classifier.cnn_1D_network.add_train_op">
<code class="descname">add_train_op</code><span class="sig-paren">(</span><em>name</em>, <em>balance_classes=True</em>, <em>learning_rate=0.001</em>, <em>decay_steps=None</em>, <em>decay_rate=None</em>, <em>piecewise_bounds=None</em>, <em>piecewise_values=None</em>, <em>method='Adam'</em>, <em>wd_lambda=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/classifier.html#cnn_1D_network.add_train_op"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.add_train_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a loss op and training op from a specific loss function and optimiser. User gives the ops a             name, and the train op and loss opp are stored in a dictionary (train_ops) under that name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>str</em>) – Name of the training op (to refer to it later in-case of multiple training ops).</li>
<li><strong>balance_classes</strong> (<em>boolean</em>) – Weight the samples during training so that the contribtion to the loss of each                             class is balanced by the number of samples the class has (in a given batch).</li>
<li><strong>learning_rate</strong> (<em>float</em>) – Controls the degree to which the weights are updated during training.</li>
<li><strong>decay_steps</strong> (<em>int</em>) – Epoch frequency at which to decay the learning rate.</li>
<li><strong>decay_rate</strong> (<em>float</em>) – Fraction at which to decay the learning rate.</li>
<li><strong>piecewise_bounds</strong> (<em>int list</em>) – Epoch step intervals for decaying the learning rate. Alternative to decay steps.</li>
<li><strong>piecewise_values</strong> (<em>float list</em>) – Rate at which to decay the learning rate at the piecewise_bounds.</li>
<li><strong>method</strong> (<em>str</em>) – Optimisation method.</li>
<li><strong>wd_lambda</strong> (<em>float</em>) – Scalar to control weighting of weight decay in loss.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.classifier.cnn_1D_network.predict_features">
<code class="descname">predict_features</code><span class="sig-paren">(</span><em>modelName</em>, <em>dataSamples</em>, <em>layer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/classifier.html#cnn_1D_network.predict_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.predict_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the predicted feature values at a particular layer of the network.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>modelName</strong> (<em>str</em>) – Name of the model to use (previously added with add_model() )</li>
<li><strong>dataSamples</strong> (<em>np.array</em>) – Shape [numSamples x inputSize]</li>
<li><strong>layer</strong> (<em>int</em>) – Layer at which to extract features. Must be between 1 and numLayers inclusive.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Values of neurons at layer. Shape [numSamples x numNeurons] if fully-connected layer and                         [numSamples x convDim1 x convDim2] if convolutional layer.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.classifier.cnn_1D_network.predict_labels">
<code class="descname">predict_labels</code><span class="sig-paren">(</span><em>modelName</em>, <em>dataSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/classifier.html#cnn_1D_network.predict_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.predict_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the predicted classification labels of some dataSamples using a trained model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>modelName</strong> (<em>str</em>) – Name of the model to use (previously added with add_model() )</li>
<li><strong>dataSamples</strong> (<em>array</em>) – Shape [numSamples x inputSize]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Predicted classification labels of dataSamples. Shape [numSamples].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.classifier.cnn_1D_network.predict_scores">
<code class="descname">predict_scores</code><span class="sig-paren">(</span><em>modelName</em>, <em>dataSamples</em>, <em>useSoftmax=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/classifier.html#cnn_1D_network.predict_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.predict_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the predicted classification scores of some dataSamples using a trained model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>modelName</strong> (<em>str</em>) – Name of the model to use (previously added with add_model() ).</li>
<li><strong>dataSamples</strong> (<em>np.array</em>) – Shape [numSamples x inputSize].</li>
<li><strong>useSoftmax</strong> (<em>boolean</em>) – Pass predicted scores output by network through a softmax function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Predicted classification scores of dataSamples. Shape [numSamples x numClasses].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.classifier.cnn_1D_network.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>dataTrain, dataVal, train_op_name, n_epochs, save_addr, visualiseRateTrain=0, visualiseRateVal=0, save_epochs=[1000]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/classifier.html#cnn_1D_network.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.classifier.cnn_1D_network.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls network_ops function to train a network.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataTrain</strong> (<em>obj</em>) – Iterator object for training data.</li>
<li><strong>dataVal</strong> (<em>obj</em>) – Iterator object for validation data.</li>
<li><strong>train_op_name</strong> (<em>str</em>) – Name of training op created.</li>
<li><strong>n_epochs</strong> (<em>int</em>) – Number of loops through dataset to train for.</li>
<li><strong>save_addr</strong> (<em>str</em>) – Address of a directory to save checkpoints for desired epochs, or address of saved                         checkpoint. If address is for an epoch and contains a previously saved checkpoint, then the                         network will start training from there. Otherwise it will be trained from scratch.</li>
<li><strong>visualiseRateTrain</strong> (<em>int</em>) – Epoch rate at which to print training loss in console.</li>
<li><strong>visualiseRateVal</strong> (<em>int</em>) – Epoch rate at which to print validation loss in console.</li>
<li><strong>save_epochs</strong> (<em>int list</em>) – Epochs to save checkpoints at.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-deephyp.data">
<span id="deephyp-data-module"></span><h2>deephyp.data module<a class="headerlink" href="#module-deephyp.data" title="Permalink to this headline">¶</a></h2>
<p>Description: high-level classes for using hyperspectral data with the deep learning modules.</p>
<ul class="simple">
<li>File name: data.py</li>
<li>Author: Lloyd Windrim</li>
<li>Date created: June 2019</li>
<li>Python package: deephyp</li>
</ul>
<dl class="class">
<dt id="deephyp.data.HypImg">
<em class="property">class </em><code class="descclassname">deephyp.data.</code><code class="descname">HypImg</code><span class="sig-paren">(</span><em>spectralInput</em>, <em>labels=None</em>, <em>wavelengths=None</em>, <em>bands=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/data.html#HypImg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.data.HypImg" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for handling data. Stores meta-data and contains attributes for pre-processing the data. If passed labels,         samples with label zero are considered as a background class. This class is not included in numClasses and data         samples with this label have a one-hot vector label of all zeros.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spectralInput</strong> (<em>np.array float</em>) – Spectral dataset. Shape can be [numRows x numCols x numBands] or             [numSamples x numBands].</li>
<li><strong>wavelengths</strong> (<em>np.array float</em>) – Vector of wavelengths that spectralInput wavelengths lie within.</li>
<li><strong>bands</strong> (<em>np.array int</em>) – Wavelength indexes for each band of spectralInput. Shape [numBands].</li>
<li><strong>labels</strong> (<em>np.array int</em>) – Class labels for each spectral sample in spectralInput. Shape can be [numRows x numCols]             or [numSamples].</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="deephyp.data.HypImg.spectra">
<code class="descname">spectra</code><a class="headerlink" href="#deephyp.data.HypImg.spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Un-pre-processed spectral data with shape [numSamples x numBands].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">np.array float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.data.HypImg.spectraCube">
<code class="descname">spectraCube</code><a class="headerlink" href="#deephyp.data.HypImg.spectraCube" title="Permalink to this definition">¶</a></dt>
<dd><p>If data passed as image - un-pre-processed spectral datacube with             shape [numSamples x numBands]. Else None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">np.array float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.data.HypImg.spectraPrep">
<code class="descname">spectraPrep</code><a class="headerlink" href="#deephyp.data.HypImg.spectraPrep" title="Permalink to this definition">¶</a></dt>
<dd><p>Pre-processed spectral data with shape [numSamples x numBands].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">np.array float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.data.HypImg.numSamples">
<code class="descname">numSamples</code><a class="headerlink" href="#deephyp.data.HypImg.numSamples" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of spectra.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.data.HypImg.numRows">
<code class="descname">numRows</code><a class="headerlink" href="#deephyp.data.HypImg.numRows" title="Permalink to this definition">¶</a></dt>
<dd><p>If data passed as image - the number of image rows. Else None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.data.HypImg.numCols">
<code class="descname">numCols</code><a class="headerlink" href="#deephyp.data.HypImg.numCols" title="Permalink to this definition">¶</a></dt>
<dd><p>If data passed as image - the number of image columns. Else None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.data.HypImg.wavelengths">
<code class="descname">wavelengths</code><a class="headerlink" href="#deephyp.data.HypImg.wavelengths" title="Permalink to this definition">¶</a></dt>
<dd><p>If provided - vector of wavelengths that spectra wavelengths lie within. Else None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">np.array float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.data.HypImg.bands">
<code class="descname">bands</code><a class="headerlink" href="#deephyp.data.HypImg.bands" title="Permalink to this definition">¶</a></dt>
<dd><p>If provided - wavelength indexes for each band of spectra with shape [numBands]. Else None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">np.array int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.data.HypImg.labels">
<code class="descname">labels</code><a class="headerlink" href="#deephyp.data.HypImg.labels" title="Permalink to this definition">¶</a></dt>
<dd><p>If provided - class labels for each spectral sample with shape [numSamples]. Else None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">np.array int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.data.HypImg.labelsOnehot">
<code class="descname">labelsOnehot</code><a class="headerlink" href="#deephyp.data.HypImg.labelsOnehot" title="Permalink to this definition">¶</a></dt>
<dd><p>If labels provided - the one-hot label vector for each sample. Samples with label             zero (background class) have a one-hot vector of all zeros. Else None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">np.array int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.data.HypImg.pre_process">
<code class="descname">pre_process</code><span class="sig-paren">(</span><em>method='minmax'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/data.html#HypImg.pre_process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.data.HypImg.pre_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Pre-process data for input into the network. Stores in the spectraPrep attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>method</strong> (<em>str</em>) – Method of pre-processing. Current options: ‘minmax’</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="deephyp.data.Iterator">
<em class="property">class </em><code class="descclassname">deephyp.data.</code><code class="descname">Iterator</code><span class="sig-paren">(</span><em>dataSamples</em>, <em>targets</em>, <em>batchSize=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/data.html#Iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.data.Iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for iterating through data, to train the network.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataSamples</strong> (<em>np.array float</em>) – Data to be input into the network. Shape [numSamples x numBands].</li>
<li><strong>targets</strong> (<em>np.array int</em>) – Network output target of each dataSample. For classification, these are the class                 labels, and it could be the dataSamples for autoencoders. Shape [numSamples x arbitrary]</li>
<li><strong>batchSize</strong> (<em>int</em>) – Number of dataSamples per batch</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="deephyp.data.Iterator.dataSamples">
<code class="descname">dataSamples</code><a class="headerlink" href="#deephyp.data.Iterator.dataSamples" title="Permalink to this definition">¶</a></dt>
<dd><p>Data to be input into the network. Shape [numSamples x numBands].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">np.array float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.data.Iterator.targets">
<code class="descname">targets</code><a class="headerlink" href="#deephyp.data.Iterator.targets" title="Permalink to this definition">¶</a></dt>
<dd><p>Network output target of each dataSample. For classification, these are the class                 labels, and it could be the dataSamples for autoencoders. Shape [numSamples x arbitrary]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">np.array int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.data.Iterator.batchSize">
<code class="descname">batchSize</code><a class="headerlink" href="#deephyp.data.Iterator.batchSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of dataSamples per batch. If None - set to numSamples (i.e. whole dataset).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.data.Iterator.numSamples">
<code class="descname">numSamples</code><a class="headerlink" href="#deephyp.data.Iterator.numSamples" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of data samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="deephyp.data.Iterator.currentBatch">
<code class="descname">currentBatch</code><a class="headerlink" href="#deephyp.data.Iterator.currentBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of indexes specifying the data samples in the current batch.                 Shape [batchSize]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.data.Iterator.get_batch">
<code class="descname">get_batch</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/data.html#Iterator.get_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.data.Iterator.get_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a specified set of samples and targets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx</strong> (<em>int list</em>) – Indexes of samples (and targets) to return.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">2-element tuple containing:<ul class="simple">
<li>(<em>np.array float</em>) - Batch of data samples at [idx] indexes. Shape [length(idx) x numBands].</li>
<li>(<em>np.array int</em>) - Batch of targets at [idx] indexes. Shape [length(idx) x arbitrary].</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tuple)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.data.Iterator.next_batch">
<code class="descname">next_batch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/data.html#Iterator.next_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.data.Iterator.next_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return next batch of samples and targets (with batchSize number of samples). The currentBatch indexes are             incremented. If end of dataset reached, the indexes wraps around to the beginning.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">2-element tuple containing:<ul class="simple">
<li>(<em>np.array float</em>) - Batch of data samples at currentBatch indexes. Shape [batchSize x numBands].</li>
<li>(<em>np.array int</em>) - Batch of targets at currentBatch indexes. Shape [batchSize x arbitrary].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(tuple)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="deephyp.data.Iterator.reset_batch">
<code class="descname">reset_batch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/data.html#Iterator.reset_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.data.Iterator.reset_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets the current batch to the beginning.</p>
</dd></dl>

<dl class="method">
<dt id="deephyp.data.Iterator.shuffle">
<code class="descname">shuffle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/data.html#Iterator.shuffle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.data.Iterator.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly permutes all dataSamples (and corresponding targets).</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-deephyp.network_ops">
<span id="deephyp-network-ops-module"></span><h2>deephyp.network_ops module<a class="headerlink" href="#module-deephyp.network_ops" title="Permalink to this headline">¶</a></h2>
<p>Description: various functions for deep learning built on-top of tensorflow. The high-level modules in the package
call these functions.</p>
<ul class="simple">
<li>File name: network_ops.py</li>
<li>Author: Lloyd Windrim</li>
<li>Date created: June 2019</li>
<li>Python package: deephyp</li>
</ul>
<dl class="function">
<dt id="deephyp.network_ops.balance_classes">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">balance_classes</code><span class="sig-paren">(</span><em>y_target</em>, <em>num_classes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#balance_classes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.balance_classes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the class weights needed to balance the classes, based on the number of samples of each class in the         batch of data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y_target</strong> (<em>tensor</em>) – One-hot classification labels (1D vector). Shape [numSamples x numClasses]</li>
<li><strong>num_classes</strong> (<em>int</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A weighting for each class that balances their contribution to the loss. Shape [numClasses].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.conv_output_shape">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">conv_output_shape</code><span class="sig-paren">(</span><em>inputShape</em>, <em>filterSize</em>, <em>padding</em>, <em>stride</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#conv_output_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.conv_output_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the expected output shape (for the convolving axis only) of a convolution layer given an input shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inputShape</strong> (<em>int</em>) – Shape of convolving axis of input data.</li>
<li><strong>filterSize</strong> (<em>int</em>) – Size of filter/kernel of convolution layer.</li>
<li><strong>stride</strong> (<em>int</em>) – Stride at which to convolve (must be &gt;= 1).</li>
<li><strong>padding</strong> (<em>str</em>) – Type of padding to use (‘SAME’ or ‘VALID’).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Output shape of convolving axis for given layer and input shape.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(int)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.create_variable">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">create_variable</code><span class="sig-paren">(</span><em>shape</em>, <em>method='gaussian'</em>, <em>wd=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#create_variable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.create_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup a trainable variable (collection of parameters) of a particular shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>shape</strong> (<em>list</em>) – Data shape.</li>
<li><strong>method</strong> (<em>str</em>) – How to initialise parameter values.</li>
<li><strong>wd</strong> (<em>boolean</em>) – Setup weight decay for this variable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Set of parameters for the given variable.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.init_weight">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">init_weight</code><span class="sig-paren">(</span><em>opts</em>, <em>shape</em>, <em>stddev=0.1</em>, <em>const=0.1</em>, <em>wd=False</em>, <em>dtype=tf.float32</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#init_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.init_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight initialisation function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>opts</strong> (<em>str</em>) – Method for initialising variable. (‘gaussian’,’truncated_normal’,’xavier’,’xavier_improved’,             ‘constant’).</li>
<li><strong>shape</strong> (<em>list</em>) – Data shape.</li>
<li><strong>stddev</strong> (<em>int</em>) – Standard deviation used by ‘gaussian’ and ‘truncated_normal’ variable initialisation methods.</li>
<li><strong>const</strong> (<em>int</em>) – Constant value to initialise variable to if using ‘constant’ method.</li>
<li><strong>wd</strong> (<em>boolean</em>) – Whether this variable contributes to weight decay or not.</li>
<li><strong>dtype</strong> (<em>tf.dtype</em>) – Data type for variable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">weights</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.layer_activation">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">layer_activation</code><span class="sig-paren">(</span><em>input</em>, <em>func='sigmoid'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#layer_activation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.layer_activation" title="Permalink to this definition">¶</a></dt>
<dd><p>Define an activation function operation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input</strong> (<em>tensor</em>) – Data input into the function.</li>
<li><strong>func</strong> (<em>str</em>) – Type of activation function. (relu, sigmoid, linear).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Computes activation. Shape is same as input.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.layer_conv1d">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">layer_conv1d</code><span class="sig-paren">(</span><em>input</em>, <em>W</em>, <em>b</em>, <em>stride=1</em>, <em>padding='SAME'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#layer_conv1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.layer_conv1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a 1 dimensional convolution layer operation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input</strong> (<em>tensor</em>) – Data input into the layer. Shape [numSamples x numInputNeurons x numFiltersIn].</li>
<li><strong>W</strong> (<em>tensor</em>) – Weight parameters of the filters/kernels. Shape [filterSize x numFiltersIn x numFiltersOut].</li>
<li><strong>b</strong> (<em>tensor</em>) – Bias parameters for the layer. Shape [numFiltersOut].</li>
<li><strong>stride</strong> (<em>int</em>) – Stride at which to convolve (must be &gt;= 1).</li>
<li><strong>padding</strong> (<em>str</em>) – Type of padding to use (‘SAME’ or ‘VALID’).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Computes layer output. Shape [numSamples x numOutputNeurons x numFiltersOut].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.layer_deconv1d">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">layer_deconv1d</code><span class="sig-paren">(</span><em>input</em>, <em>W</em>, <em>b</em>, <em>outputShape</em>, <em>stride=1</em>, <em>padding='SAME'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#layer_deconv1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.layer_deconv1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a 1 dimensional deconvolution layer operation. Also called convolutional transpose or upsampling layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input</strong> (<em>tensor</em>) – Data input into the layer. Shape [numSamples x numInputNeurons x numFiltersIn].</li>
<li><strong>W</strong> (<em>tensor</em>) – Weight parameters of the filters/kernels. Shape [filterSize x numFiltersOut x numFiltersIn].</li>
<li><strong>b</strong> (<em>tensor</em>) – Bias parameters for the layer. Shape [numFiltersOut].</li>
<li><strong>outputShape</strong> (<em>list</em>) – Expected shape of the layer output. Shape [numSamples x numOutputNeurons x numFiltersOut].</li>
<li><strong>stride</strong> (<em>int</em>) – Stride at which to convolve (must be &gt;= 1).</li>
<li><strong>padding</strong> (<em>str</em>) – Type of padding to use (‘SAME’ or ‘VALID’).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Computes layer output. Shape [numSamples x numOutputNeurons x numFiltersOut].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.layer_fullyConn">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">layer_fullyConn</code><span class="sig-paren">(</span><em>input</em>, <em>W</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#layer_fullyConn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.layer_fullyConn" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a fully connected layer operation. Also called a ‘dense’ layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input</strong> (<em>tensor</em>) – Data input into the layer. Shape [numSamples x numInputNeurons].</li>
<li><strong>W</strong> (<em>tensor</em>) – Weight parameters for the layer. Shape [numInputNeurons x numOutputNeurons].</li>
<li><strong>b</strong> (<em>tensor</em>) – Bias parameters for the layer. Shape [numOutputNeurons].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Computes layer output. Shape [numSamples x numOutputNeurons].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.load_config">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">load_config</code><span class="sig-paren">(</span><em>net_obj</em>, <em>addr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#load_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.load_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a network config file. Loads from variables in the config.json file and overwrites variables in network         object. Applies to variables in the net_config list in the network object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>net_obj</strong> (<em>obj</em>) – Network object.</li>
<li><strong>addr</strong> (<em>obj</em>) – Directory location of config.json file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.load_model">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">load_model</code><span class="sig-paren">(</span><em>addr</em>, <em>sess</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a model from the address of a checkpoint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>addr</strong> (<em>str</em>) – Address of a directory to save checkpoint for current epoch.</li>
<li><strong>sess</strong> (<em>obj</em>) – Tensor flow session object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.loss_function_crossentropy_1D">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">loss_function_crossentropy_1D</code><span class="sig-paren">(</span><em>y_pred</em>, <em>y_target</em>, <em>class_weights=None</em>, <em>num_classes=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#loss_function_crossentropy_1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.loss_function_crossentropy_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Cross entropy loss function op, comparing 1D tensors for network prediction and target. Weights the classes         when calculating the loss to balance un-even training batches. If class weights are not provided, then no         weighting is done (weight of 1 assigned to each class).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y_pred</strong> (<em>tensor</em>) – Output of network (1D vector of class scores). Shape [numSamples x numClasses].</li>
<li><strong>y_target</strong> (<em>tensor</em>) – One-hot classification labels (1D vector). Shape [numSamples x numClasses].</li>
<li><strong>class_weights</strong> (<em>tensor</em>) – Weight for each class. Shape [numClasses].</li>
<li><strong>num_classes</strong> (<em>int</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Cross-entropy loss.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.loss_function_reconstruction_1D">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">loss_function_reconstruction_1D</code><span class="sig-paren">(</span><em>y_reconstructed</em>, <em>y_target</em>, <em>func='SSE'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#loss_function_reconstruction_1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.loss_function_reconstruction_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruction loss function op, comparing 1D tensors for network reconstruction and target.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y_reconstructed</strong> (<em>tensor</em>) – Output of network (reconstructed 1D vector). Shape [numSamples x inputSize].</li>
<li><strong>y_target</strong> (<em>tensor</em>) – What the network is trying to reconstruct (1D vector). Shape [numSamples x inputSize].</li>
<li><strong>func</strong> (<em>string</em>) – The name of the loss function to be used. ‘SSE’-sum of square errors,’CSA’-cosine spectral angle,             ‘SA’-spectral angle, ‘SID’-spectral information divergence.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Reconstruction loss.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.loss_weight_decay">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">loss_weight_decay</code><span class="sig-paren">(</span><em>wdLambda</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#loss_weight_decay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.loss_weight_decay" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight decay loss op, regularises network by penalising parameters for being too large.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>wdLambda</strong> (<em>float</em>) – Scalar to control weighting of weight decay in loss.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Weight-decay loss.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.save_config">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">save_config</code><span class="sig-paren">(</span><em>net_obj</em>, <em>addr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#save_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.save_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a network config file. Saves the variables listed in net_config within the network object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>net_obj</strong> (<em>obj</em>) – Network object.</li>
<li><strong>addr</strong> (<em>obj</em>) – Directory of where to store the config.json file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.save_model">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">save_model</code><span class="sig-paren">(</span><em>addr</em>, <em>sess</em>, <em>saver</em>, <em>current_epoch</em>, <em>epochs_to_save</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#save_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a checkpoint at a list of epochs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>addr</strong> (<em>str</em>) – Address of a directory to save checkpoint for current epoch.</li>
<li><strong>sess</strong> (<em>obj</em>) – Tensor flow session object.</li>
<li><strong>saver</strong> (<em>obj</em>) – Tensor flow save object.</li>
<li><strong>current_epoch</strong> (<em>int</em>) – The current epoch.</li>
<li><strong>epochs_to_save</strong> (<em>int list</em>) – Epochs to save checkpoints at.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.train">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">train</code><span class="sig-paren">(</span><em>net_obj, dataTrain, dataVal, train_op_name, n_epochs, save_addr, visualiseRateTrain=0, visualiseRateVal=0, save_epochs=[1000]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for training a network. Updates the network weights through the training op. The function will check         the save address for a model checkpoint to load, otherwise it will begin training from scratch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>net_obj</strong> (<em>obj</em>) – Network object.</li>
<li><strong>dataTrain</strong> (<em>obj</em>) – Iterator object for training data.</li>
<li><strong>dataVal</strong> (<em>obj</em>) – Iterator object for validation data.</li>
<li><strong>train_op_name</strong> (<em>string</em>) – Name of training op created.</li>
<li><strong>n_epochs</strong> (<em>int</em>) – Number of loops through dataset to train for.</li>
<li><strong>save_addr</strong> (<em>str</em>) – Address of a directory to save checkpoints for desired epochs, or address of saved checkpoint.                         If address is for an epoch and contains a previously saved checkpoint, then the network will                         start training from there. Otherwise it will be trained from scratch.</li>
<li><strong>visualiseRateTrain</strong> (<em>int</em>) – Epoch rate at which to print training loss in console.</li>
<li><strong>visualiseRateVal</strong> (<em>int</em>) – Epoch rate at which to print validation loss in console.</li>
<li><strong>save_epochs</strong> (<em>int list</em>) – Epochs to save checkpoints at.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="deephyp.network_ops.train_step">
<code class="descclassname">deephyp.network_ops.</code><code class="descname">train_step</code><span class="sig-paren">(</span><em>loss</em>, <em>learning_rate=0.001</em>, <em>decay_steps=None</em>, <em>decay_rate=None</em>, <em>piecewise_bounds=None</em>, <em>piecewise_values=None</em>, <em>method='Adam'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deephyp/network_ops.html#train_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deephyp.network_ops.train_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Operation for training the weights of the network by optimising them to minimise the loss function. Note that         the default is a constant learning rate (no decay).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>loss</strong> (<em>tensor</em>) – Output of network loss function.</li>
<li><strong>learning_rate</strong> – (float) Controls the degree to which the weights are updated during training.</li>
<li><strong>decay_steps</strong> (<em>int</em>) – Epoch frequency at which to decay the learning rate.</li>
<li><strong>decay_rate</strong> (<em>float</em>) – Fraction at which to decay the learning rate.</li>
<li><strong>piecewise_bounds</strong> (<em>int list</em>) – Epoch step intervals for decaying the learning rate. Alternative to decay steps.</li>
<li><strong>piecewise_values</strong> (<em>float list</em>) – Rate at which to decay the learning rate at the piecewise_bounds.</li>
<li><strong>method</strong> (<em>str</em>) – Optimisation method. (Adam, SGD).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(op) A train op.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-deephyp">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-deephyp" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Lloyd Windrim

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>